<search-bar>
  <form (submit)="submit()" ngNativeValidate>
    <input-label [(ngModel)]="request.branch_id" class="dark id-field"
                 name="branch_id" type="number">
      ID de sucursal
    </input-label>
    <app-branch-search (selected)="request.branch_id = $event.id"></app-branch-search>

    <input-label [(ngModel)]="request.product_id"  class="dark id-field"
                 name="product_id" type="number">
      ID de producto
    </input-label>
    <app-product-search (selected)="request.product_id = $event.id"></app-product-search>

    <input-label [(ngModel)]="request.quantity" class="dark id-field"
                 name="quantity" type="number">
      Cantidad
    </input-label>
    <input-label [(ngModel)]="request.price" class="dark id-field"
                 name="price" type="number">
      Precio
    </input-label>
    <input-label [(ngModel)]="request.minimum" class="dark id-field"
                 name="minimum" type="number">
      MÃ­nimo
    </input-label>
    <button md-raised-button color="accent" type="submit">
      <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>
      Consultar
    </button>
    <button md-raised-button color="accent" type="button" (click)="downloadCSV()">
      <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>
      CSV
    </button>
  </form>
</search-bar>
<main-content>
  <h2>Reporte de inventario</h2>
  <ul>
    <li *ngIf="inventories"> Registros de inventario: {{inventories.length}}</li>
    <li>Registros de inventario con existencias {{productsWithExistences}}</li>
    <li>Productos diferentes registrados: {{registeredProducts}}</li>
  </ul>
  <table>
    <thead>
    <tr>
      <th>Sucursal</th>
      <th>ID</th>
      <th>Producto</th>
      <th>Categorias</th>
      <th>Marca</th>
      <th>Cantidad</th>
      <th>Precio</th>
      <th>Precio Total</th>
      <th>Costo</th>
      <th>Minimo</th>
    </tr>
    </thead>
    <ng-template ngFor let-inventory [ngForOf]="inventories">
      <tr>
        <td>{{inventory.branch.name}}</td>
        <td>{{inventory.id}}</td>
        <td>{{inventory.product.description}}</td>
        <td>{{implode(inventory.product.categories)}}</td>
        <td>{{inventory.product.brand ? inventory.product.brand.name : ''}}</td>
        <td>{{inventory.quantity}}</td>
        <td>{{inventory.price | myCurrency}}</td>
        <td>{{inventory.quantity * inventory.price | myCurrency}}</td>
        <td>/* pendiente */</td>
        <td>{{inventory.minimum}}</td>
      </tr>
    </ng-template>
  </table>
</main-content>
