<search-bar>
  <form (submit)="submit()">
    <input-label [(ngModel)]="request.product_id"  class="dark id-field"
                 name="product_id" type="number">
      ID de producto
    </input-label>
    <app-product-search (selected)="request.product_id = $event.id"></app-product-search>

    <input-label [(ngModel)]="request.branch_id" class="dark id-field"
                 name="branch_id" type="number">
      ID de sucursal
    </input-label>
    <app-branch-search (selected)="request.branch_id = $event.id"></app-branch-search>

    <input-label [(ngModel)]="request.user_id" class="dark id-field"
                 name="user_id" type="number">
      ID de usuario
    </input-label>
    <app-user-search (selected)="request.user_id = $event.id"></app-user-search>
    <input-label [(ngModel)]="request.inventory_movement_type_id" class="dark id-field"
                 name="inventory_movement_type" type="number">
      Tipo de movimiento
    </input-label>
    <my-date-range-picker placeholder="Rango de fechas"
                          (dateRangeChanged)="onDateRangeChanged($event)"
                          [options]="rangeOptions" ></my-date-range-picker>

    <button md-raised-button color="accent" type="submit">
      <i class="fa fa-arrow-circle-right" aria-hidden="true"></i>
      Consultar
    </button>
    <button md-raised-button color="accent" type="button" (click)="downloadCSV()">
      <i class="fa fa-arrow-circle-down" aria-hidden="true"></i>
      CSV
    </button>
  </form>
</search-bar>
<main-content>
  <h2>Reporte de entradas/salidas</h2>
  <ul>
    <li *ngIf="inventory_movements">Cantidad de movimientos total: {{inventory_movements.length}}</li>
    <li>Total de entradas: {{totalUp}}</li>
    <li>Total de salidas: {{totalDown}}</li>
  </ul>
  <table>
    <thead>
    <tr>
      <th>ID</th>
      <th>Fecha</th>
      <th>Sucursal</th>
      <th>Usuario</th>
      <th>Producto</th>
      <th>Cantidad</th>
      <th>Tipo de movimiento</th>
    </tr>
    </thead>
    <template ngFor let-inventoryMovement [ngForOf]="inventory_movements">
      <tr>
        <td>{{inventoryMovement.id}}</td>
        <td>{{inventoryMovement.created_at | date:'short'}}</td>
        <td>{{inventoryMovement.inventory.name}}</td>
        <td>{{inventoryMovement.user.name}}</td>
        <td>{{inventoryMovement.product.description}}</td>
        <td>{{inventoryMovement.quantity}}</td>
        <td>{{inventoryMovement.inventory_movement_type.name}}</td>
      </tr>
    </template>
  </table>
</main-content>
